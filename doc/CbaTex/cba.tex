\documentclass[conference,harvard,brazil,english]{sbatex}
%\documentclass[submission,journal, harvard,brazil,english]{sbatex}
\usepackage[latin1]{inputenc}
\usepackage{ae}

\makeatletter
\def\verbatim@font{\normalfont\ttfamily\footnotesize}
\makeatother
\usepackage{amsmath}
\usepackage{graphicx} % for image
\usepackage{color} % for image (?)
\usepackage{textcomp} % for copyright / registered symbols
\DeclareGraphicsExtensions{.png}
% --------------------------------------------------


\begin{document}

\title{ALOCAÇÃO DE CAPACITORES EM REDES EXTENSAS DE DISTRIBUIÇÃO DE ENERGIA ELÉTRICA}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% O processo de revisao do CBA 2014 sera DOUBLE BLIND, portanto NAO inclua
% autores na versão que será submetida para revisão
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\author{Luiz Le Roy Hipólito de
% Jesus}{luiz.hipolito@axxiom.com.br}

%\address{Endereço do Luiz Le Roy e do Lucas Barros\\ Rua dos Inconfidentes, 1051\\ Belo Horizonte, MG, Brasil}

%\author[1]{Lucas Barros Honório Silva}{lucas.silva@axxiom.com.br}

%\author{Pedro Manoel}{pedro@pedro.com}
%\address{Endereço do Pedro e do Rafael\\ Em algum lugar\\ Cidade, Estado, País}

%\author{José Rodrigues}{jose@rodrigues}
%\address{Endereço do José\\ Em algum lugar\\ Cidade, Estado, País}

%\author[3]{Rafael Pires}{rafael@pires}

\twocolumn[

\maketitle

%\selectlanguage{english}
%\begin{abstract}
%The objective\ldots
%\end{abstract}

%\keywords{Distribution System\ldots}

\selectlanguage{brazil}
\begin{abstract}
O objetivo deste trabalho é  buscar por melhorias na qualidade de distribuição de energia em sistemas de grande porte.
Através de uma técnica de otimização robusta, monoobjetivo, denominada PSO (Particle Swarm Optimization) apresenta-se 
um método para alocar bancos de capacitores (cargas altamente capacitivas) onde o foco é a minimização de uma
função objetivo proposta para tal fim. 
Durante este trabalho é possível obter a minimização das perdas e melhoria no perfil de tensão ao longo da linha
dos alimentadores de energia após a inserção, nos devidos pontos, de
equipamentos capacitivos. 
Na literatura este tipo de problema é conhecido como \emph{Optimal Capacitor
Placement} - OCP.
\end{abstract}

\keywords{Sistema de Distribuição, OCP, Redução de Perdas, Perfil de tensão, PSO, Inteligência de Enxames, Computação Evolucionaria.}

]

\section{Introdução}
Manter o perfil operacional da rede de distribuição de energia dentro dos limites adequados é um problema que deve ser modelado e resolvido
obedecendo a restrições de natureza técnica e, sempre que possível, considerar
detalhes econômicos que envolvem a implantação e manutenção.
O problema abordado durante este trabalho é minimizar o fluxo de carga e
reduzir as perdas ao longo da rede de distribuição (o circuito alimentador) com a inserção de banco de capacitores nos pontos adequados
do sistema.

Apos o período de construção da rede de distribuição ocorre degradação da qualidade do perfil de tensão como 
consequência das dificuldades de prever condições precisas de carga durante a fase de planejamento do sistema. 
Desta maneira torna-se necessário o planejamento de curto prazo da rede de distribuição, com a instalação de
dispositivos que assegurem que o sistema opere dentro dos limites de magnitude de tensão estabelecidos pelas agencias reguladoras. 
Dentre os dispositivos, destaca-se a alocação de bancos de capacitores, que instalados de forma adequada proporcionam a 
compensação de reativos, regulando as magnitudes das tensões ao longo da rede, bem como o fator de potencia da subestação. 
Fornecendo como beneficio principal a redução de perdas ativas no sistema.

Durante este trabalho foi utilizado informações de carregamento elétrico
do circuito, impedâncias envolvidas e sua topologia. A contribuição do procedimento desenvolvido é 
especificar a posição de instalação de bancos de capacitores ao longo de 
um alimentador de energia.
Buscando sempre otimizar perdas elétricas e queda de tensão ao longo da linha. 
O objetivo é melhorar a capacidade e qualidade da distribuição de energia.
 
 Durante a construção do sistema para posicionamento dos capacitores (OCP)
 utiliza-se do cálculo do fluxo de carga da linha de distribuição e de algum
 método de otimização para a solução de um problema não linear. Muitas formas
 de aplicação e manipulações de funções objetivos típicas de desafios desta
 natureza são observadas em ~\citeasnoun{del2008particle}.

\section{Formulação do problema}
O problema foi formulado buscando encontrar pontos ótimos de alocação de capacitores em redes de grande extensão.
 A topologia de rede (alimentadores longos com número grande de cargas distribuídas e milhares de barras) é 
 muito similar ao que ocorre na prática no sistema de distribuição de energia
 do nordeste do estado de Minas Gerais. 
 
 A alocação destes equipamentos de potência seguirá as seguintes diretivas:

\begin{itemize}
  \item Minimizar a perda de energia ao longo do circuito.
  \item Elevar níveis de tensão abaixo do valor nominal,
  \item garantindo normas elétricas vigentes do PRODIST Módulo 8 (~\citeasnoun{aneel2012procedimentos}).
\end{itemize}
 
 Nas duas próximas subseções, que descrevem o método de cálculo para o fluxo
 elétrico e o processo de otimização, explica-se como é realizado na prática a solução para o OCP.

\subsection{Cálculo do fluxo de carga}
Fluxo de potência ou fluxo de carga (load flow) é o estudo de sistemas de
potência em condição de regime permanente. É um estudo que demanda uma
análise numérica extensa, que para grandes sistemas são necessárias técnicas simplificadas, como notação por unidade (pu) e componentes simétricas. 
Trata-se de um problema matemático, formado por um conjunto de equações diferenciais parciais, cuja solução permite determinar os valores de tensão, 
potência e corrente em cada um dos pontos do sistema em estudo.

O método de varredura, ou Backward-Forward, foi utilizado para o cálculo de perdas, necessários para determinar o valor da função objetivo. 
Nos sistemas radiais de distribuição com apenas uma fonte de tensão, localizada na barra de referência, o cálculo é realizado de
forma unidirecional, isto é, da barra de referência para as barras terminais. 
O método Backward-Forward calcula o fluxo em dois passos. 
No primeiro (backward), obtém-se a potência ativa e a potência reativa das extremidades para a barra de referência, 
assim como a injeção de corrente. No segundo passo (forward) calculam-se as magnitudes e os
ângulos de tensão a partir da barra de referência, em que a tensão normalmente é fixada em 1,0pu e o ângulo em zero. 
Subtrai-se a queda de tensão em cada barra até chegar às extremidades. 
O cálculo algébrico é feito com as variáveis na forma complexa, 
iterativamente até que a convergência seja atingida. Vide ~\citeasnoun{hamouda2006efficient}.

\subsection{Metodologia de minimização via PSO (Particle Swarm
Optimization) } 
A função objetivo a ser minimizada é simples. Partindo de uma topologia com
todos os cálculos de fluxo de carga realizados (a potência ativa e reativa, bem como o módulo e ângulo de tensão 
e corrente por fase ABC, em todas as barras e linhas respectivamente), é possível somar as perdas ao longo
do circuito, que serão minimizadas ao inserir bancos de capacitores na rede de alimentação.

É importante observar que, uma restrição importante do problema, está relacionada a variação da tensão ao longo do 
circuito durante a alocação dos capacitores. Ela é analisada com auxílio da equação abaixo,
denominada VDI (voltage deviation index) em ~\citeasnoun{abul2013optimal}.

\begin{equation} \label{vdi} 
  VDI = \sqrt{\sum^{nb}_{b=ini}\frac{(V_{b} - V)^2}{nb}}
\end{equation}

Na equação \ref{vdi} o somatório percorre todas as barras calculando a
o erro quadrático médio entre o valor estimado $V_{barra}$ e a tensão nominal,
similar ao cálculo de ~\citeasnoun{abul2013optimal}.
Durante este trabalho o nível de tensão máxima foi seguido de acordo com a faixa
indicada no anexo I de ~\citeasnoun{aneel2012procedimentos}. Utilizando o devido critério para
o circuito de teste, conforme consta na seção dos resultados.

O espaço de busca para o problema de alocação dos capacitores (em redes extensas) pode atingir dimensões enormes.
É possível obter o tamanho deste espaço através da relação entre a quantidade $n$ de barras candidatas
a receber um equipamento com uma quantidade máxima $b$ de capacitores disponíveis. Isto leva um conjunto de
testes inviáveis para cálculos de força bruta, conforme ilustrado no somatório de
combinações da equação \ref{comb}.

\begin{equation} \label{comb} 
  \sum^b_{i=0} C_{n,i} =\sum^b_{i=0} \frac{n!}{(n-i)!i!}
\end{equation}

No contexto deste trabalho a tendência é que o usuário conheça as especificações
do(s) banco(s) de capacitores para alocar em um determinado ponto do circuito.
Portanto, ao trabalhar com bancos com tap fixo, é usual
em circuitos com um número grande de barras e linhas (para este modelo a ordem é de 2500 conexões)
inserir até 5 cargas capacitivas. 
Neste caso, podemos obter o ótimo em todas as combinações
de $n=2500$ barras candidatas com 5, 4, 3, 2, 1 ou 0 alocações. 
O número total de possibilidades, neste caso específico, é da ordem de $10^{14}$.
  
O procedimento usual em métodos estocásticos (e adotado neste trabalho) durante o processo de minimização
(ou maximização) de funções objetivos de múltiplas variáveis e iniciar com uma população de pontos de avaliação
(cálculo de funções) e evoluir até encontrar um valor satisfatório para servir de solução ao problema. Neste caso,
obtém-se a avaliação da função através do método de cálculo de fluxo de carga por varredura e
utiliza-se a técnica de otimização inteira descrita em ~\citeasnoun{del2008particle}.

O algoritmo se adapta atualizando um parâmetro denominado velocidade, com auxílio de boas experiências de
iterações anteriores. Conforme ~\citeasnoun{zhang2008active}, ~\citeasnoun{sedlaczek2006using} e ~\citeasnoun{yarmohamadi2012capaictor}).
No PSO, a velocidade $v_i^d$ e a posição $x_i^d$ da d-ésima dimensão da i-ésima partícula é atualizada
conforme ~\ref{vel} e ~\ref{pos}:

\begin{equation} \label{vel}
\begin{split}
  v_i^d = w \cdot v_i^d +c_1 \cdot r_1 \cdot (pbest_i^d-x_i^d)
  \\
  + c_2 \cdot r_2 \cdot (gbest^d-x_i^d)
\end{split}
\end{equation}

\begin{equation} \label{pos} 
 x_i^d = x_i^d + v_i^d 
\end{equation}

Onde:
\begin{itemize}
  \item $x_i$ é a posição de uma partícula na iteração $i$ (ponto de avaliação da função objetivo);
  \item $v_i$ é definido como a velocidade de uma partícula na iteração $i$;
  \item $pbest_i$ é a melhor localização no espaço de busca para a partícula $i$;
  \item $gbest$ é a melhor localização encontrada a cada iteração;
  \item $w$ é o peso inercial que controla o impacto da velocidade anterior no momento atual;
  \item $r_1$ e $r_2$ são dois valores independentes uniformemente distribuídos entre $[0,1)$ e
  \item $c_1$,$c_2$ são dois coeficientes positivos que controlam a contribuição de pbest e gbest.
\end{itemize}
 
A equação ~\ref{vel} é usada para calcular o nova velocidade de acordo com a velocidade
anterior e a distância entre a posição corrente e a melhor posição anterior da partícula (pbest). Também é
contabilizado a inteligência do grupo, através da posição anterior e o valor gbest. 
O processo é repetido até um número máximo de iterações ($imax$). 
O peso inercial, durante este trabalho, recebeu um decaimento exponencial, a cada iteração $i$, 
de acordo com a equação ~\ref{inert}, controlado pelas constantes $w_1$ e $w_2$:

\begin{equation} \label{inert} 
 w = w_1 \cdot e^{\frac{-w_{2}\cdot i}{imax}}
\end{equation}

Durante o processo evolutivo da otimização, para um ganho de diversidade, foi elaborado um método de mutação das partículas.
A uma taxa baixa de probabilidade, cada partícula pode, eventualmente, sofrer uma alteração em seus valores para evitar
que a resposta leve à um ótimo local.

\section{Requisitos computacionais}
Todos os cálculos para o fluxo de carga, e a otimização por métodos evolucionários (PSO) foram codificados em C ANSI.
um dos focos deste trabalho foi o desempenho. Portanto, durante a solução do OCP, diversos testes em situações extremas foram realizados.
Protótipos foram construídos e problemas conhecidos foram solucionados para a validação da metodologia. Funções com os valores
ótimos conhecidos, como a função de De Jong, o vale de Rosenbrock, função de Rastrigin, função de Schwefel entre outras foram
utilizadas para calibrar os algoritmos desenvolvidos durante este trabalho. Utilizou-se ~\citeasnoun{molga2005test} para esta análise.

Em um teste de desempenho foi necessário um tempo de processamento considerado alto, de aproximadamente 3 horas, para o pior caso modelado. 
Somando isto ao fato de que, no PSO, pode-se realizar simultaneamente uma grande quantidade de cálculos, uma estratégia de paralelismo foi construída.
Todas as funções objetivo de uma geração foram calculadas em paralelo, com auxílio da API 
OpenMP\textregistered. Descrita em ~\citeasnoun{chapman2008using}. É importante
lembrar que, para esta melhoria no desempenho computacional através de paralelismo de núcleos, um maior uso de memória é necessário para processar todos os cálculos
de fluxo de carga de uma única vez. Os resultados de ganho de desempenho, em termos absolutos, estão resumidos na tabela \ref{tab}.

\begin{table}[position specifier]
  \centering
  \begin{tabular}{| l | l | l |}
  \hline                       
  Duração do processo & Núcleos & $\frac{serial}{paralelo}$\\
  \hline
  10.885,378s $\approx$ 3h & serial & - \\
  02.613,357s $\approx$ 43min & 8 & 4,165 \\
  01.105,509s $\approx$ 18min & 24 & 9,846 \\
  \hline
\end{tabular}
  \caption{Teste de desempenho}
  \label{tab}
\end{table}

% & Intel Core i5 3.10GHz 
% & Intel Core i7 2 GHz 
% & Intel Xeon e5 2.30GHz

%ADEPT: pode ilustrar bem os resultados, ao se comparar...
\section{Resultados}
A rede de distribuição de energia extensa utilizada neste trabalho foi construída com 2500 barras, 2500 linhas (radial) e 1500 cargas distribuídas.
Após a análise observa-se a necessidade de inserção de quatro bancos de capacitores próximos ao início do 
circuito (na barra de alimentação) conforme
ilustrado na figura \ref{top}. A região onde os capacitores foram instalados está mais a esquerda no diagrama, 
onde encontra-se o início do alimentador (a topologia de desenho é left-right). O retângulo na figura destaca a
região de alocação.

\begin{figure}[ht!]
\centering
%\includegraphics[width=75mm]{axxxx-firstResultRepresentation.png}
\includegraphics[width=75mm]{axxxx.png}
\caption{Localização topológica dos capacitores alocados}
\label{top}
\end{figure}

Com esta alocação é possível obter uma redução nas perdas elétricas. A potência dissipada passa de $84,2KW + 48,0KVA_r$
quando o circuito não possui cargas capacitivas, para $76,1KW + 42,5KVA_r$ após a correta distribuição de quatro 
bancos de capacitores com $100KVA_r$.

A análise deste caso atingiu o melhor valor encontrado com 20 gerações, através do método por enxame de partículas.
Para cada geração foi necessário calcular 50 fluxos de carga, para obtenção do módulo de perdas do circuito elétrico (ou seja, 50
pontos no PSO). A evolução do valor de gbest, em comparação com a média aritmética de pbest, pode ser visualizada na
figura \ref{evol}, que contém também os valores da geração inicial, totalizando 21 iterações.

\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{evolucao-P-G-Best.png}
\caption{Evolução do PSO ao longo de 20/21 gerações}
\label{evol}
\end{figure}

A taxa de mutação, durante este experimento, foi mantida relativamente alta, devido à grande extensão da rede. 
Seu valor, para a maioria das simulações, foi de 10\% dos indivíduos.  Assim, foi possível obter um valor final de perdas
$9,7KVA$ menor, quando comparado com um circuito sem compensação capacitiva, com uma quantidade baixa de iterações.

O perfil de tensão melhorou, pois o valor de VDI (equação \ref{vdi}) passou de $0,0351$ para $0,0337$.
É importante observar que, tanto para o circuito original quanto para o circuito otimizado, o nível de tensão foi verificado
e mantido dentro da norma (menor que 1,05pu para esta rede de 13,8kV). Apesar da melhoria no nível de tensão inferior,
esta continua abaixo de 0,95pu. 
As figuras \ref{perfil} e \ref{perfilz} indicam ganhos na qualidade de energia após a inserção dos bancos de capacitores. Os círculos em vermelho
indicam o nível de tensão em todas as 2500 barras sem alocação de capacitores. As marcas em azul indicam o aumento
desejado no nível de tensão (após inserir os equipamentos).

\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{tensao-barras.png}
\caption{Perfil de tensão com e sem alocação de capacitores}
\label{perfil}
\end{figure}

%PNG
\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{tensao-barras-ZOOM.png}
\caption{Perfil de tensão com e sem alocação de capacitores (fim de circuito)}
\label{perfilz}
\end{figure}

%2498 barras.
%2497 linhas.
%1319 cargas.
%13.8kV.
%Radial.

%SERÁ QUE A DIFERENÇA É DEVIDO AS CHAVES?

%No Diagrama Ortogonal Hierárquico:
%2851 barras
%2852 linhas

\section{Conclusões}
Observa-se que, ao inserir grupos de capacitores em pontos específicos da rede, 
é possível reduzir perdas ativas e reativas no sistema diminuindo a corrente no tronco
principal do alimentador (início de circuito). Em paralelo, a variação no nível de tensão 
ao longo das barras fica mais estabilizada, trazendo os valores para a proximidade da
tensão nominal (1pu). 

\section*{Agradecimentos}
Agradecemos a todos que contribuíram com dicas, testes e revisões durante este trabalho.

% BIBLIOGRAFIA
\bibliography{bib}
\end{document}