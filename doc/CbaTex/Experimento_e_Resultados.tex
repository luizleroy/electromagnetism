\section{Experimentos e resultados} \label{exp}
%2498 barras.
%2497 linhas.
%1319 cargas.
%13.8kV.
%Radial.
%No Diagrama Ortogonal Hierárquico:
%2851 barras
%2852 linhas
A rede de distribuição de energia extensa utilizada neste trabalho foi construída com 2498 barras, 2497 linhas (radial) e 1319 cargas distribuídas. Todos os cálculos foram realizados para um sistema elétrico real, trifásico, com cargas elétricas desbalanceadas.

A análise atingiu a convergência com 15 gerações, através do método por enxame de partículas. Para cada geração foi necessário calcular 80 vezes o fluxos de carga (ou seja, 80 partículas no PSO). A evolução do valor de \textit{gBest}, em comparação com \textit{pBest}, pode ser visualizada na \Fig \ref{evol}. Esta evolução, traçada durante a minimização de \Eq \ref{eq_obj1-perdas}, foi capaz de reduzir as perdas, ao inerir capacitores em pontos específicos da rede. E também diminuir a corrente no tronco principal do alimentador. Antes alocação dos capacitores, a corrente  era de 174,3 A e foi reduzida para 160,0 A.

\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{evolucao-P-G-Best.pdf}
\caption{Evolução do PSO ao longo de 15 gerações}
\label{evol}
\end{figure}

\subsection{Redução de perdas}

A redução nas perdas elétricas, ocorreu após inserção de 750 kVAr de potência reativa, através de 5 bancos de capacitores trifásicos com ligação estrela aterrada. A potência dissipada passa de $84,2kW + 48,0kVA_r$ quando o circuito não possui cargas capacitivas, para $76,1kW + 42,5kVA_r$ após a correta distribuição dos equipamentos. O valor final das perdas foi de $96,9kVA$ para $87,2kVA$. Uma redução maior que $9,7kVA$, que corresponde a 10\% do valor inicial.

Após a análise observa-se a necessidade de inserção bancos de capacitores próximos ao início do circuito (na barra de alimentação) conforme ilustrado na Fig. \ref{fig_top-orto}. Esta figura representa a rede de forma ortogonal e hierárquica, sendo útil para exibir o sistema com foco no nível de distribuição das barras da fonte para a carga. A região onde os capacitores foram instalados, para minimização das perdas, está mais a esquerda no diagrama. Onde encontra-se o início do alimentador. A topologia de desenho é definida como \textit{left-right}.

%PDF: origem YED
\begin{figure*}[ht!]
\centering
\includegraphics[width=155mm]{axxxx-05.pdf}
\caption{Diagrama Ortogonal e Hierárquico: Perfil topológico do alimentador com a ligação ortogonal entre barras. Para redução de perdas, a alocação é no início do circuito (lado esquerdo).}
\label{fig_top-orto}
\end{figure*}

\subsection{Estabilização do perfil de tensão}

Para melhorias no nível de tensão, foi realizada a minimização da \Eq \ref{eq_vdi}. A \Fig \ref{fig_top-geo} destaca a região de alocação de um único banco de capacitor para este fim. Observa-se que os capacitores que estabilizam o nível de tensão, normalmente, encontram-se em fim de circuito. 

%origem ADEPT
\begin{figure*}[ht!]
\centering
\includegraphics[width=155mm]{axxxx-geo.pdf}
\caption{Diagrama Georreferenciado: Perfil topológico do alimentador com a ligação direta entre as barras. Para melhorias na tensão do sistema, a alocação ocorre nas pontas do circuito.}
\label{fig_top-geo}
\end{figure*}

O valor de VDI, durante este trabalho foi de $0,0351$ para $0,0190$. É importante observar que, tanto para o circuito original quanto para o circuito otimizado, o nível de tensão foi verificado e mantido dentro da norma. Menor que 1,05 pu e maior que 0,95 pu para esta rede de 13,8 kV, de acordo com o indicado no anexo I de \citeasnoun{aneel2012procedimentos}.

As Figs. \ref{perfil} e \ref{perfilz} ilustram ganhos na qualidade no nível de tensão após a inserção dos bancos de capacitores. O valor de tensão, em pu, de todas as 2498 barras, sem alocação de capacitores é representado com a curva inferior. A curva superior mostra que foi possível manter o sistema dentro das normas do PRODIST, no que tange a variação da tensão.

%PDF
\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{tensao-barras.pdf}
\caption{Perfil de tensão com e sem alocação de capacitores}
\label{perfil}
\end{figure}

%PDF
\begin{figure}[ht!]
\centering
\includegraphics[width=75mm]{tensao-barras-ZOOM.pdf}
\caption{Perfil de tensão com e sem alocação de capacitores (fim de circuito)}
\label{perfilz}
\end{figure}

\subsection{Comparações com a literatura}

A primeira proposta é compará-lo a um procedimento padrão, encontrado na literatura. Ao utilizar um processo sequencial, com uma análise barra à barra do alimentador, é preciso realizar algum tipo de decisão, optando por priorizar alguma característica do sistema durante análise. O procedimento utilizado para comparação, que realiza tratamento de perdas e desvios de tensão, encontra-se descrito em \citeasnoun{alcantra}.

Após adaptações necessárias no algoritmo, para comportar redes extensas e a disponibilidade de recursos  utilizou-se o seguinte procedimento formal, aplicado à rede de teste proposta neste artigo. Neste tipo de análise, tanto a potência quanto a granularidade dos capacitores alocados precisa ser definida inicialmente.

\begin{enumerate}[a)]
\item Resolver o fluxo de carga e calcular as tensões do sistema;
\vspace{-3mm}
\item Identificar a barra com a menor tensão e instalar um banco de capacitores de 150kVAr (50kVAr por fase);
\vspace{-3mm}
\item Resolver o fluxo de carga e calcular as tensões do sistema modificado;
\vspace{-3mm}
\item Voltar ao passo a) apenas se a menor tensão do sistema for menor que 0,95 pu ou a maior tensão do sistema for maior que 1,05 pu.
\\
A alocação de capacitores precisa ser menor que um determinado valor (no caso, 750 kVAr) ou um determinado número de bancos disponíveis (5 x 150 kVar). 
\vspace{-3mm}
\item Identificar a barra que proporciona a maior redução nas perdas de potência ativa do sistema e instalar um banco de capacitores de 150 kVAr nessa barra;
\vspace{-3mm}
\item Resolver o fluxo de carga;
\vspace{-3mm}
\item Calcular as perdas ativas do sistema;
\vspace{-3mm}
\item Voltar ao passo e) enquanto for possível reduzir as perdas de potência ativa do sistema ou  o total dos bancos de capacitores instalados for menor do que 750 kVAr. Ou seja, o restante dos recursos disponíveis. 
\end{enumerate}
\textbf{Após esta etapa, apenas um banco foi alocado.} \textbf{Nesta etapa foram alocados três dispositivos, totalizando 600 kVAr na rede.} As comparações encontram-se na \Tab \ref{tab_final_comparacao}.

\begin{table*}[ht!]
  \centering
  \begin{tabular}{| l | l | l | l |}
  \hline
  Tipo & VDI & Perdas & Alocações\\
  \hline
	PSO por Perdas: & 0,02321 & 13,4 kVA &  \\
  PSO por VDI:& 0,01157 &  61,8 kVA &   \\
	\hline
	PSO (VDI e Perdas): & 0,02124 & 14,0 kVA & \\
	\hline
	Algoritmo Greedy:  & 0,02393 & 15,1  kVA & 1; 30; 96 e 2496 \\
	Sem alocação:  & 0,02654 & 15,3  kVA & sem alocação \\
	\hline
\end{tabular}
  \caption{Comparação: PSO x Algoritmo Guloso }
  \label{tab_final_comparacao}
\end{table*}

O espaço de busca para o problema de alocação dos capacitores (em redes extensas) pode atingir é um conjunto muito grande, devido a natureza combinatória do problema. É possível obter o tamanho deste espaço através da relação entre a quantidade $n$ de barras candidatas a receber um determinado equipamento, com uma quantidade máxima $b$ de capacitores disponíveis. Isto leva um conjunto de testes praticamente inviáveis para cálculos de força bruta, conforme ilustrado no somatório de combinações da equação \ref{comb}.
\begin{equation} \label{comb}
  \sum^b_{i=0} C_{n,i} =\sum^b_{i=0} \frac{n!}{(n-i)!i!}
\end{equation}
No contexto deste trabalho assume-se que o usuário conheça as especificações do(s) banco(s) de capacitores para alocar em um determinado ponto do circuito. Portanto, ao trabalhar com bancos com tap fixo, é usual em circuitos com um número grande de barras e linhas (para este modelo a ordem é de 2500 conexões) inserir até 5 cargas capacitivas.
Neste caso, podemos obter o ótimo em todas as combinações de $n=2500$ barras candidatas com 5, 4, 3, 2, 1 ou 0 alocações.
O número total de possibilidades, neste caso específico, é da ordem de $10^{14}$.

\begin{table}[ht!]
  \centering
  \begin{tabular}{| l | l | l |}
  \hline
  Método & Calc. $f(\textbf{x})$ & Alocações Exatas\\
  \hline
  Força Bruta & 2500 & 100\% \\
	PSO 1 & 100 & 45\% \\
	PSO 2 & 225 & 94\% \\
  \hline
\end{tabular}
  \caption{Comparação: PSO x Força Bruta }
  \label{tab_forca_bruta}
\end{table}

Outro estudo foi realizado através da comparação do algoritmo de otimização PSO com uma análise por força bruta. Por questões de viabilidade computacional, foi testado, em todas as barras, qual seria aquela que traria menor perda quando for disponível para alocação apenas um único banco capacitivo de $100kVA_r$. Observa-se que, a otimização evolucionária utilizada neste trabalho, é capaz de encontrar o ponto ótimo para este problema reduzido com um número inferior a 4\% de cálculos de fluxo de carga (em relação ao tamanho do espaço de busca). E também com um percentual elevado de acertos, conforme consta na Tab. \ref{tab_forca_bruta}. 

A metodologia proposta, em cada teste da tabela, foi executada 100 vezes para definição do percentual de acerto. No primeiro teste (PSO 1), o algoritmo foi calibrado para realizar o cálculo da função objetivo, e, consequentemente o cálculo do fluxo de carga 100 vezes. Este foi o número de chamadas a f(\textbf{x}) em cada iteração, portanto, o teste inteiro executou 10.000 cálculos da função objetivo. Em seguida, após executar o cálculo da função objetivo 225 vezes (PSO 2), um número menor que o tamanho do espaço de busca (2500 barras candidatas), o nível de precisão foi bastante elevado (94\%, conforme consta na \Tab \ref{tab_forca_bruta}). E mesmo nas simulações em que não foi encontrada exatamente a mesma barra obtida pelo método por força bruta, é possível encontrar uma barra com valor similar de perdas. Esta característica se deve a granularidade da distribuição de cargas do sistema. Mesmo no pior caso, onde utiliza-se 100 cálculos de $f(\textbf{x})$, a perda de potência é inferior a 2,\% para todas as simulações, conforme demonstrado pela linha superior da Fig. \ref{fig_forca_bruta}. \textbf{Na simulação PSO 2 o erro é menor que a precisão do sistema para todas as simulações.}

%PDF
\begin{figure}
\centering
\includegraphics[width=75mm]{plotForcaBrutaVersusOCP.pdf}
\caption{Erro máximo durante 100 simulações de duas configurações do PSO}
\label{fig_forca_bruta}
\end{figure}